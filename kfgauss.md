---
title: Вычисление интегралов при помощи КФ Гаусса
author:
    - Кубышкин Ефим, группа 21.Б07-мм
    - и Пономарев Николай, группа 21.Б10-мм
documentclass: memoir
classoption: oneside
header-includes: |
    \input{preamble.tex}
geometry:
    - margin=1cm
---

Требуется вычислить интеграл вида $$\int_a^b f(x) dx,$$
самостоятельно построив КФ Гаусса.

Для построения КФ Гаусса для $[a, b] = [-1, 1]$ сначала строится многочлен Лежандра степени $N$ по рекуррентной формуле, затем вычисляются его корни -- они станут узлами.
Для вычисления коэффициентов используется многочлен Лежандра степени $N-1$.

Далее для приведения к произвольным $[a, b]$ к узлам и коэффициентам применяются линейные преобразования.

Сначала программа выводит коэффициенты КФ Гаусса при $N = 1...8$ и $[a,b] = [-1,1]$, а затем проверяет точность некоторых $N$ на многочленах степени $2N - 1$.
Далее программа запрашивает у пользователя границы интегрирования, строит КФ Гаусса для $N=6,7,8$ для $f = \sqrt{x} \cdot \cos x^2$, при этом выводятся приведенные узлы и коэффициенты, далее выводятся результаты вычислений и их абсолютные погрешности.

Примеры работы:
```sh
> poetry run python Task52.py
Вычисление интегралов при помощи КФ Гаусса

Узлы и коэффициенты КФ Гаусса при N = 1...8 на [-1, 1]

N=1
+-----+-----+
| x_k | C_k |
+-----+-----+
| 0.0 | 2.0 |
+-----+-----+

N=2
+---------------------+--------------------+
|         x_k         |        C_k         |
+---------------------+--------------------+
| -0.5773502691896256 | 1.0000000000000009 |
|  0.5773502691896258 | 0.9999999999999996 |
+---------------------+--------------------+

N=3
+---------------------+--------------------+
|         x_k         |        C_k         |
+---------------------+--------------------+
| -0.7745966692414833 | 0.5555555555555564 |
|         0.0         | 0.8888888888888888 |
|  0.7745966692414834 | 0.5555555555555552 |
+---------------------+--------------------+

N=4
+---------------------+---------------------+
|         x_k         |         C_k         |
+---------------------+---------------------+
|  -0.861136311594052 |  0.3478548451374604 |
| -0.3399810435848566 |  0.6521451548625453 |
| 0.33998104358485637 |  0.6521451548625459 |
|  0.8611363115940529 | 0.34785484513744996 |
+---------------------+---------------------+

N=5
+---------------------+---------------------+
|         x_k         |         C_k         |
+---------------------+---------------------+
| -0.9061798459386626 |  0.2369268850562083 |
|  -0.538469310105683 | 0.47862867049936686 |
|         0.0         |  0.5688888888888889 |
|  0.5384693101056831 | 0.47862867049936647 |
|  0.9061798459386663 | 0.23692688505615572 |
+---------------------+---------------------+

N=6
+---------------------+---------------------+
|         x_k         |         C_k         |
+---------------------+---------------------+
| -0.9324695142031523 |  0.171324492379165  |
| -0.6612093864662645 | 0.36076157304813955 |
|  -0.238619186083197 | 0.46791393457269076 |
| 0.23861918608319702 | 0.46791393457269076 |
|  0.6612093864662641 | 0.36076157304814155 |
|  0.9324695142031513 |  0.1713244923791827 |
+---------------------+---------------------+

N=7
+---------------------+---------------------+
|         x_k         |         C_k         |
+---------------------+---------------------+
| -0.9491079123427573 | 0.12948496616889069 |
| -0.7415311855993927 | 0.27970539148929274 |
| -0.4058451513773975 | 0.38183005050511787 |
|         0.0         | 0.41795918367346935 |
| 0.40584515137739713 | 0.38183005050511903 |
|  0.7415311855993952 |  0.279705391489272  |
|  0.9491079123427567 | 0.12948496616889985 |
+---------------------+---------------------+

N=8
+----------------------+---------------------+
|         x_k          |         C_k         |
+----------------------+---------------------+
|  -0.960289856497536  | 0.10122853629037323 |
| -0.7966664774136268  | 0.22238103445337729 |
| -0.5255324099163294  |  0.3137066458778851 |
| -0.18343464249564972 | 0.36268378337836216 |
| 0.18343464249564972  | 0.36268378337836216 |
|  0.5255324099163289  |  0.3137066458778872 |
|  0.7966664774136288  | 0.22238103445336138 |
|  0.9602898564975336  | 0.10122853629043015 |
+----------------------+---------------------+

Проверка точности КФ Гаусса на [-1, 1]

+-----------+-----------------+-------------------------+------------------------+
| Многочлен | Точное значение |   Вычисленное значение  |      Погрешность       |
+-----------+-----------------+-------------------------+------------------------+
|    x^5    |        0        |  -2.220446049250313e-16 | 2.220446049250313e-16  |
|    x^7    |        0        |  -2.789435349370706e-15 | 2.789435349370706e-15  |
|    x^9    |        0        | -1.8110513089197866e-14 | 1.8110513089197866e-14 |
+-----------+-----------------+-------------------------+------------------------+

Вычисление интеграла от f(x) = sqrt(x) * cos(x^2)

Введите левую границу интегрирования: 1
Введите правую границу интегрирования: 2
N=6
Узлы и коэффициенты
[(1.0337652428984239, 0.0856622461895825), (1.1693953067668676, 0.18038078652406977), (1.3806904069584016, 0.23395696728634538), (1.6193095930415986, 0.23395696728634538), (1.8306046932331321, 0.18038078652407077), (1.9662347571015757, 0.08566224618959135)]
+-------------------------+---------------------+------------------------+
|          Метод          |       Значение      |      Погрешность       |
+-------------------------+---------------------+------------------------+
| Точное значение (SciPy) | -0.5963227286825986 | 8.318582885349825e-15  |
|        КФ Гаусса        | -0.5963227096285814 | 1.9054017252884137e-08 |
+-------------------------+---------------------+------------------------+

N=7
Узлы и коэффициенты
[(1.0254460438286213, 0.06474248308444534), (1.1292344072003035, 0.13985269574464637), (1.2970774243113012, 0.19091502525255893), (1.5, 0.20897959183673467), (1.7029225756886985, 0.19091502525255952), (1.8707655927996976, 0.139852695744636), (1.9745539561713783, 0.06474248308444992)]
+-------------------------+---------------------+------------------------+
|          Метод          |       Значение      |      Погрешность       |
+-------------------------+---------------------+------------------------+
| Точное значение (SciPy) | -0.5963227286825986 | 8.318582885349825e-15  |
|        КФ Гаусса        | -0.5963227288056071 | 1.2300849228097377e-10 |
+-------------------------+---------------------+------------------------+

N=8
Узлы и коэффициенты
[(1.019855071751232, 0.05061426814518662), (1.1016667612931865, 0.11119051722668864), (1.2372337950418353, 0.15685332293894255), (1.4082826787521752, 0.18134189168918108), (1.5917173212478248, 0.18134189168918108), (1.7627662049581645, 0.1568533229389436), (1.8983332387068144, 0.11119051722668069), (1.9801449282487669, 0.05061426814521507)]
+-------------------------+---------------------+------------------------+
|          Метод          |       Значение      |      Погрешность       |
+-------------------------+---------------------+------------------------+
| Точное значение (SciPy) | -0.5963227286825986 | 8.318582885349825e-15  |
|        КФ Гаусса        | -0.5963227286847268 | 2.1281865159039626e-12 |
+-------------------------+---------------------+------------------------+

Желаете ли вы ввести новые значения? [y/yes/да] n

```
