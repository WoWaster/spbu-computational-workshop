---
title: Приближённое вычисление интегралов при помощи квадратурных формул Наивысшей Алгебраической Степени Точности (КФ НАСТ)
author:
    - Кубышкин Ефим, группа 21.Б07-мм
    - и Пономарев Николай, группа 21.Б10-мм
documentclass: memoir
classoption: oneside
header-includes: |
    \input{preamble.tex}
geometry:
    - margin=1cm
---

Требуется вычислить интеграл вида $$\int_a^b \rho(x) f(x) dx,$$
самостоятельно построив ИКФ, а затем КФНАСТ.

Для построения ИКФ из промежутка интегрирования выбирается $N$ точек, затем вычисляются $\mu_0, \dots, \mu_{N-1}$, затем вычисляются коэффициенты ИКФ путём решения СЛАУ.

Для построения КФНАСТ вычисляются $\mu_0, \dots, \mu_{2N-1}$, затем вычисляются коэффициенты приведенного многочлена $\omega$ путем решения СЛАУ, затем вычисляются корни $\omega$, они уже используются в качестве $x_k$ для построения ИКФ способом описанным выше.

Для вычислений используется $\rho = \cos(x)$.
Программа запрашивает у пользователя границы интегрирования и количество узлов $N$ для построения ИКФ и КФНАСТ.
Сначала вычисляется интеграл по заданной функции $f(x)$, в данном случае $f(x) = \sin(x)$, затем для проверки АСТ полученных формул вычисляются интегралы от $x^{N-1}$ и $x^{2N-1}$.

Примеры работы:
```sh
> poetry run python Task51.py
Тема: Приближённое вычисление интегралов при помощи квадратурных формул Наивысшей Алгебраической Степени Точности (КФ НАСТ)
Введите левую границу интегрирования: 0
Введите правую границу интегрирования: 1
Введите количество точек для построения КФ: 5
ρ = cos(x)
f(x) = sin(x)
Вычисление ИКФ
Используемые узлы:
x_0 = 0.0
x_1 = 0.25
x_2 = 0.5
x_3 = 0.75
x_4 = 1.0
Найденные моменты весовой функции:
μ_0 = 0.8414709848078965
μ_1 = 0.3817732906760362
μ_2 = 0.23913362692838294
μ_3 = 0.1717381583560983
μ_4 = 0.13307668513986026
Найденные коэффициенты ИКФ:
A_0 = 0.07961194283241824
A_1 = 0.3373658200000942
A_2 = 0.12729973781514348
A_3 = 0.25364606956719854
A_4 = 0.04354741459304201
----------------------------------------
Вычисление КФНАСТ
Найденные моменты весовой функции:
μ_0 = 0.8414709848078965
μ_1 = 0.3817732906760362
μ_2 = 0.23913362692838294
μ_3 = 0.1717381583560983
μ_4 = 0.13307668513986026
μ_5 = 0.1082193470266288
μ_6 = 0.09098426582092765
μ_7 = 0.07837455076646482
μ_8 = 0.06877054578106546
μ_9 = 0.06122408243568808
Найденный ортогональный многочлен
ω = -0.00358101 + 0.11022272·x - 0.78995978·x² + 2.15030268·x³ -
2.46225849·x⁴ + 1.0·x⁵
Найденные узлы:
x_0 = 0.045679441415265
x_1 = 0.22427150596178885
x_2 = 0.48702309028518603
x_3 = 0.7563661073788538
x_4 = 0.9489183460764026
Найденные коэффициенты КФНАСТ:
A_0 = 0.1151366606041197
A_1 = 0.22659267576320924
A_2 = 0.24734694175600516
A_3 = 0.177977717133105
A_4 = 0.07441698955145741
+-------------------------+---------------------+-----------------------+
|          Метод          |       Значение      |      Погрешность      |
+-------------------------+---------------------+-----------------------+
| Точное значение (SciPy) |  0.3540367091367856 | 3.930597060461789e-15 |
|           ИКФ           |  0.3540352631393934 | 1.445997392213183e-06 |
|          КФНАСТ         | 0.35403670913693497 | 1.493805079633148e-13 |
+-------------------------+---------------------+-----------------------+
================================================================================
f(x) = x^4
Вычисление ИКФ
Используемые узлы:
x_0 = 0.0
x_1 = 0.25
x_2 = 0.5
x_3 = 0.75
x_4 = 1.0
Найденные моменты весовой функции:
μ_0 = 0.8414709848078965
μ_1 = 0.3817732906760362
μ_2 = 0.23913362692838294
μ_3 = 0.1717381583560983
μ_4 = 0.13307668513986026
Найденные коэффициенты ИКФ:
A_0 = 0.07961194283241824
A_1 = 0.3373658200000942
A_2 = 0.12729973781514348
A_3 = 0.25364606956719854
A_4 = 0.04354741459304201
----------------------------------------
Вычисление КФНАСТ
Найденные моменты весовой функции:
μ_0 = 0.8414709848078965
μ_1 = 0.3817732906760362
μ_2 = 0.23913362692838294
μ_3 = 0.1717381583560983
μ_4 = 0.13307668513986026
μ_5 = 0.1082193470266288
μ_6 = 0.09098426582092765
μ_7 = 0.07837455076646482
μ_8 = 0.06877054578106546
μ_9 = 0.06122408243568808
Найденный ортогональный многочлен
ω = -0.00358101 + 0.11022272·x - 0.78995978·x² + 2.15030268·x³ -
2.46225849·x⁴ + 1.0·x⁵
Найденные узлы:
x_0 = 0.045679441415265
x_1 = 0.22427150596178885
x_2 = 0.48702309028518603
x_3 = 0.7563661073788538
x_4 = 0.9489183460764026
Найденные коэффициенты КФНАСТ:
A_0 = 0.1151366606041197
A_1 = 0.22659267576320924
A_2 = 0.24734694175600516
A_3 = 0.177977717133105
A_4 = 0.07441698955145741
+-------------------------+---------------------+------------------------+
|          Метод          |       Значение      |      Погрешность       |
+-------------------------+---------------------+------------------------+
| Точное значение (SciPy) | 0.13307668513986026 | 1.4774479988306529e-15 |
|           ИКФ           | 0.13307668513986026 |          0.0           |
|          КФНАСТ         | 0.13307668513986026 |          0.0           |
+-------------------------+---------------------+------------------------+
================================================================================
f(x) = x^9
Вычисление ИКФ
Используемые узлы:
x_0 = 0.0
x_1 = 0.25
x_2 = 0.5
x_3 = 0.75
x_4 = 1.0
Найденные моменты весовой функции:
μ_0 = 0.8414709848078965
μ_1 = 0.3817732906760362
μ_2 = 0.23913362692838294
μ_3 = 0.1717381583560983
μ_4 = 0.13307668513986026
Найденные коэффициенты ИКФ:
A_0 = 0.07961194283241824
A_1 = 0.3373658200000942
A_2 = 0.12729973781514348
A_3 = 0.25364606956719854
A_4 = 0.04354741459304201
----------------------------------------
Вычисление КФНАСТ
Найденные моменты весовой функции:
μ_0 = 0.8414709848078965
μ_1 = 0.3817732906760362
μ_2 = 0.23913362692838294
μ_3 = 0.1717381583560983
μ_4 = 0.13307668513986026
μ_5 = 0.1082193470266288
μ_6 = 0.09098426582092765
μ_7 = 0.07837455076646482
μ_8 = 0.06877054578106546
μ_9 = 0.06122408243568808
Найденный ортогональный многочлен
ω = -0.00358101 + 0.11022272·x - 0.78995978·x² + 2.15030268·x³ -
2.46225849·x⁴ + 1.0·x⁵
Найденные узлы:
x_0 = 0.045679441415265
x_1 = 0.22427150596178885
x_2 = 0.48702309028518603
x_3 = 0.7563661073788538
x_4 = 0.9489183460764026
Найденные коэффициенты КФНАСТ:
A_0 = 0.1151366606041197
A_1 = 0.22659267576320924
A_2 = 0.24734694175600516
A_3 = 0.177977717133105
A_4 = 0.07441698955145741
+-------------------------+----------------------+------------------------+
|          Метод          |       Значение       |      Погрешность       |
+-------------------------+----------------------+------------------------+
| Точное значение (SciPy) | 0.06122408243568808  | 6.797238598164954e-16  |
|           ИКФ           |  0.0628422694013631  | 0.0016181869656750197  |
|          КФНАСТ         | 0.061224082435688436 | 3.5388358909926865e-16 |
+-------------------------+----------------------+------------------------+
Хотите повторить с другими данными?
[Да, да, д, y, yes], чтобы продолжить: n

```
