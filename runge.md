---
title: Задание 4.3
---
# Приближённое вычисление интеграла по составным квадратурным формулам и уточнение по принципу Рунге

Пономарев Николай, группа 21.Б10-мм

---

Требуется вычислить интеграл вида $$\int_a^b \rho(x) f(x) dx$$ с помощью квадратурных формул при $\rho (x) \equiv 1$ и $f(x)$ заданной пользователем, а затем уточнить его значение с использованием принципа Рунге.

При вычислении используют составные квадратурные формулы:
* левых прямоугольников;
* правых прямоугольников;
* средних прямоугольников;
* трапеций;
* Симпсона,
которые были реализованы в ходе выполнения задания 4.2.

В данном задании, кроме вышеупомянутых формул, используется формула Рунге:
$$\overline{J} = \frac{l^{d+1} \cdot J(h/l) - J(h)}{l^{d+1} - 1},$$
где $d$ -- алгебраическая степень точности квадратурной формулы, $h$ -- начальная длина промежутка деления, $l$ -- "делитель" промежутка деления, $J(h)$ -- интеграл с промежутком деления $h$, $J(h/l)$ -- интеграл с промежутком деления $h/l$.

Программа вычисляет сначала интегралы с использованием соответствующих составных квадратурных с разбиением $h$, затем с разбиением $h/l$, затем по принципу Рунге с помощью формулы значение уточняется.

Примеры работы:
```sh
❯ stack run rungeMethod
Тема: Приближённое вычисление интеграла по составным квадратурным формулам
Введите левую границу интеграла: 0
Введите правую границу интеграла: 5
Введите число промежутков деления отрезка: 10
Введите множитель l метода Рунге: 10

f(x) = x * exp x * sin x
╭────────────────────────────┬────────────────────────────┬────────────────────────┬──────────────────────────────┬────────────────────────┬─────────────────────┬────────────────────────╮
│           Метод            │ Вычисленное значение при h │ Абсолютная погрешность │ Вычисленное значение при h/l │ Абсолютная погрешность │ Уточненное значение │ Абсолютная погрешность │
╞════════════════════════════╪════════════════════════════╪════════════════════════╪══════════════════════════════╪════════════════════════╪═════════════════════╪════════════════════════╡
│ Точное значение            │        -440.49085448233484 │   0.0                  │          -440.49085448233484 │  0.0                   │ -440.49085448233484 │  0.0                   │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ левого прямоугольника   │        -276.177869782118   │ 164.31298470021682     │          -422.8352929026364  │ 17.65556157969843      │ -439.13056213824956 │  1.3602923440852805    │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ правого прямоугольника  │        -631.9703221393761  │ 191.47946765704125     │          -458.4145381383623  │ 17.923683656027436     │ -439.1305621382496  │  1.3602923440852237    │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ среднего прямоугольника │        -433.63236518993114 │   6.8584892924037035   │          -440.4238171585784  │  6.703732375643767e-2  │ -440.49241768351425 │  1.5632011794082246e-3 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ трапеции                │        -454.07409596074706 │  13.58324147841222     │          -440.62491552049937 │  0.13406103816453196   │ -440.48906521302206 │  1.7892693127805614e-3 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ Симпсона                │        -440.4462754468698  │   4.457903546506259e-2 │          -440.4908499458853  │  4.5364495235844515e-6 │ -440.49085440378104 │  7.8553796356573e-8    │
╰────────────────────────────┴────────────────────────────┴────────────────────────┴──────────────────────────────┴────────────────────────┴─────────────────────┴────────────────────────╯

f(x) = 34
╭────────────────────────────┬────────────────────────────┬────────────────────────┬──────────────────────────────┬────────────────────────┬─────────────────────┬────────────────────────╮
│           Метод            │ Вычисленное значение при h │ Абсолютная погрешность │ Вычисленное значение при h/l │ Абсолютная погрешность │ Уточненное значение │ Абсолютная погрешность │
╞════════════════════════════╪════════════════════════════╪════════════════════════╪══════════════════════════════╪════════════════════════╪═════════════════════╪════════════════════════╡
│ Точное значение            │                      170.0 │                    0.0 │                        170.0 │                    0.0 │               170.0 │                    0.0 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ левого прямоугольника   │                      170.0 │                    0.0 │                        170.0 │                    0.0 │               170.0 │                    0.0 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ правого прямоугольника  │                      170.0 │                    0.0 │                        170.0 │                    0.0 │               170.0 │                    0.0 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ среднего прямоугольника │                      170.0 │                    0.0 │                        170.0 │                    0.0 │               170.0 │                    0.0 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ трапеции                │                      170.0 │                    0.0 │                        170.0 │                    0.0 │               170.0 │                    0.0 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ Симпсона                │                      170.0 │                    0.0 │                        170.0 │                    0.0 │               170.0 │                    0.0 │
╰────────────────────────────┴────────────────────────────┴────────────────────────┴──────────────────────────────┴────────────────────────┴─────────────────────┴────────────────────────╯

f(x) = x
╭────────────────────────────┬────────────────────────────┬────────────────────────┬──────────────────────────────┬────────────────────────┬─────────────────────┬────────────────────────╮
│           Метод            │ Вычисленное значение при h │ Абсолютная погрешность │ Вычисленное значение при h/l │ Абсолютная погрешность │ Уточненное значение │ Абсолютная погрешность │
╞════════════════════════════╪════════════════════════════╪════════════════════════╪══════════════════════════════╪════════════════════════╪═════════════════════╪════════════════════════╡
│ Точное значение            │                      12.5  │                   0.0  │                       12.5   │                  0.0   │                12.5 │                    0.0 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ левого прямоугольника   │                      11.25 │                   1.25 │                       12.375 │                  0.125 │                12.5 │                    0.0 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ правого прямоугольника  │                      13.75 │                   1.25 │                       12.625 │                  0.125 │                12.5 │                    0.0 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ среднего прямоугольника │                      12.5  │                   0.0  │                       12.5   │                  0.0   │                12.5 │                    0.0 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ трапеции                │                      12.5  │                   0.0  │                       12.5   │                  0.0   │                12.5 │                    0.0 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ Симпсона                │                      12.5  │                   0.0  │                       12.5   │                  0.0   │                12.5 │                    0.0 │
╰────────────────────────────┴────────────────────────────┴────────────────────────┴──────────────────────────────┴────────────────────────┴─────────────────────┴────────────────────────╯

f(x) = x ** 3 - 7 * x + 7
╭────────────────────────────┬────────────────────────────┬────────────────────────┬──────────────────────────────┬────────────────────────┬─────────────────────┬────────────────────────╮
│           Метод            │ Вычисленное значение при h │ Абсолютная погрешность │ Вычисленное значение при h/l │ Абсолютная погрешность │ Уточненное значение │ Абсолютная погрешность │
╞════════════════════════════╪════════════════════════════╪════════════════════════╪══════════════════════════════╪════════════════════════╪═════════════════════╪════════════════════════╡
│ Точное значение            │                  103.75    │                0.0     │           103.75             │      0.0               │  103.75             │     0.0                │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ левого прямоугольника   │                   82.8125  │               20.9375  │           101.51562500000001 │      2.234374999999986 │  103.59375000000001 │     0.1562499999999858 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ правого прямоугольника  │                  127.8125  │               24.0625  │           106.015625         │      2.265625          │  103.59375          │     0.15625            │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ среднего прямоугольника │                  102.96875 │                0.78125 │           103.7421875        │      7.8125e-3         │  103.75             │     0.0                │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ трапеции                │                  105.3125  │                1.5625  │           103.765625         │      1.5625e-2         │  103.75             │     0.0                │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ Симпсона                │                  103.75    │                0.0     │           103.75             │      0.0               │  103.75             │     0.0                │
╰────────────────────────────┴────────────────────────────┴────────────────────────┴──────────────────────────────┴────────────────────────┴─────────────────────┴────────────────────────╯

```

```sh
❯ stack run rungeMethod
Тема: Приближённое вычисление интеграла по составным квадратурным формулам
Введите левую границу интеграла: 0
Введите правую границу интеграла: 5
Введите число промежутков деления отрезка: 100
Введите множитель l метода Рунге: 100

f(x) = x * exp x * sin x
╭────────────────────────────┬────────────────────────────┬────────────────────────┬──────────────────────────────┬────────────────────────┬─────────────────────┬────────────────────────╮
│           Метод            │ Вычисленное значение при h │ Абсолютная погрешность │ Вычисленное значение при h/l │ Абсолютная погрешность │ Уточненное значение │ Абсолютная погрешность │
╞════════════════════════════╪════════════════════════════╪════════════════════════╪══════════════════════════════╪════════════════════════╪═════════════════════╪════════════════════════╡
│ Точное значение            │        -440.49085448233484 │  0.0                   │          -440.49085448233484 │  0.0                   │ -440.49085448233484 │  0.0                   │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ левого прямоугольника   │        -422.8352929026364  │ 17.65556157969843      │          -440.3129716604452  │  0.17788282188962512   │ -440.48951387012    │  1.3406122148467148e-3 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ правого прямоугольника  │        -458.4145381383623  │ 17.923683656027436     │          -440.6687641128025  │  0.17790963046763864   │ -440.48951387012    │  1.3406122148467148e-3 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ среднего прямоугольника │        -440.4238171585784  │  6.703732375643767e-2  │          -440.4908477801909  │  6.7021439349446155e-6 │ -440.4908544839234  │  1.5885461834841408e-9 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ трапеции                │        -440.62491552049937 │  0.13406103816453196   │          -440.49086788662385 │  1.3404289006757608e-5 │ -440.49085448051983 │  1.8150103642256e-9    │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ Симпсона                │        -440.4908499458853  │  4.5364495235844515e-6 │          -440.4908544823352  │  3.410605131648481e-13 │ -440.49085448233524 │  3.979039320256561e-13 │
╰────────────────────────────┴────────────────────────────┴────────────────────────┴──────────────────────────────┴────────────────────────┴─────────────────────┴────────────────────────╯

f(x) = 34
╭────────────────────────────┬────────────────────────────┬────────────────────────┬──────────────────────────────┬────────────────────────┬─────────────────────┬────────────────────────╮
│           Метод            │ Вычисленное значение при h │ Абсолютная погрешность │ Вычисленное значение при h/l │ Абсолютная погрешность │ Уточненное значение │ Абсолютная погрешность │
╞════════════════════════════╪════════════════════════════╪════════════════════════╪══════════════════════════════╪════════════════════════╪═════════════════════╪════════════════════════╡
│ Точное значение            │                      170.0 │                    0.0 │                        170.0 │                    0.0 │               170.0 │                    0.0 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ левого прямоугольника   │                      170.0 │                    0.0 │                        170.0 │                    0.0 │               170.0 │                    0.0 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ правого прямоугольника  │                      170.0 │                    0.0 │                        170.0 │                    0.0 │               170.0 │                    0.0 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ среднего прямоугольника │                      170.0 │                    0.0 │                        170.0 │                    0.0 │               170.0 │                    0.0 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ трапеции                │                      170.0 │                    0.0 │                        170.0 │                    0.0 │               170.0 │                    0.0 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ Симпсона                │                      170.0 │                    0.0 │                        170.0 │                    0.0 │               170.0 │                    0.0 │
╰────────────────────────────┴────────────────────────────┴────────────────────────┴──────────────────────────────┴────────────────────────┴─────────────────────┴────────────────────────╯

f(x) = x
╭────────────────────────────┬────────────────────────────┬────────────────────────┬──────────────────────────────┬────────────────────────┬─────────────────────┬────────────────────────╮
│           Метод            │ Вычисленное значение при h │ Абсолютная погрешность │ Вычисленное значение при h/l │ Абсолютная погрешность │ Уточненное значение │ Абсолютная погрешность │
╞════════════════════════════╪════════════════════════════╪════════════════════════╪══════════════════════════════╪════════════════════════╪═════════════════════╪════════════════════════╡
│ Точное значение            │                     12.5   │                  0.0   │           12.5               │ 0.0                    │  12.5               │ 0.0                    │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ левого прямоугольника   │                     12.375 │                  0.125 │           12.498750000000001 │ 1.2499999999988631e-3  │  12.5               │ 0.0                    │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ правого прямоугольника  │                     12.625 │                  0.125 │           12.50125           │ 1.2500000000006395e-3  │  12.5               │ 0.0                    │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ среднего прямоугольника │                     12.5   │                  0.0   │           12.499999999999998 │ 1.7763568394002505e-15 │  12.499999999999998 │ 1.7763568394002505e-15 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ трапеции                │                     12.5   │                  0.0   │           12.5               │ 0.0                    │  12.5               │ 0.0                    │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ Симпсона                │                     12.5   │                  0.0   │           12.5               │ 0.0                    │  12.5               │ 0.0                    │
╰────────────────────────────┴────────────────────────────┴────────────────────────┴──────────────────────────────┴────────────────────────┴─────────────────────┴────────────────────────╯

f(x) = x ** 3 - 7 * x + 7
╭────────────────────────────┬────────────────────────────┬────────────────────────┬──────────────────────────────┬────────────────────────┬─────────────────────┬────────────────────────╮
│           Метод            │ Вычисленное значение при h │ Абсолютная погрешность │ Вычисленное значение при h/l │ Абсолютная погрешность │ Уточненное значение │ Абсолютная погрешность │
╞════════════════════════════╪════════════════════════════╪════════════════════════╪══════════════════════════════╪════════════════════════╪═════════════════════╪════════════════════════╡
│ Точное значение            │         103.75             │      0.0               │           103.75             │  0.0                   │  103.75             │ 0.0                    │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ левого прямоугольника   │         101.51562500000001 │      2.234374999999986 │           103.72750156250017 │  2.2498437499834267e-2 │  103.74984375000017 │ 1.5624999983288035e-4  │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ правого прямоугольника  │         106.015625         │      2.265625          │           103.77250156250017 │  2.2501562500167438e-2 │  103.74984375000017 │ 1.5624999983288035e-4  │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ среднего прямоугольника │         103.7421875        │      7.8125e-3         │           103.74999921874988 │  7.812501223725121e-7  │  103.74999999999987 │ 1.2789769243681803e-13 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ трапеции                │         103.765625         │      1.5625e-2         │           103.75000156250017 │  1.5625001736907507e-6 │  103.75000000000017 │ 1.7053025658242404e-13 │
├────────────────────────────┼────────────────────────────┼────────────────────────┼──────────────────────────────┼────────────────────────┼─────────────────────┼────────────────────────┤
│ КФ Симпсона                │         103.75             │      0.0               │           103.74999999999996 │  4.263256414560601e-14 │  103.74999999999996 │ 4.263256414560601e-14  │
╰────────────────────────────┴────────────────────────────┴────────────────────────┴──────────────────────────────┴────────────────────────┴─────────────────────┴────────────────────────╯

```
